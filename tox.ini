[tox]
env_list =
    lint
    docbuild
no_package = true

[testenv:lint]
deps = pre-commit
commands = pre-commit run --all-files --show-diff-on-failure

[testenv:docdev]
deps =
    -r requirements/doc.txt
    sphinx-autobuild

    flask
    -e packages/flask-oasis

    django
    -e packages/django-oasis

    starlette
    -e packages/starlette-oasis
commands = sphinx-autobuild {posargs} docs/ docs/_build

[testenv:docbuild]
deps =
    -r requirements/doc.txt

    django
    -e packages/django-oasis

    flask
    -e packages/flask-oasis

    starlette
    -e packages/starlette-oasis
commands = sphinx-build -E -a --fail-on-warning docs/ docs/_build

[testenv:coverage]
deps = 
    -r requirements/doc.txt

    flask
    -e packages/flask-oasis

    django
    beautifulsoup4
    -e packages/django-oasis

    starlette
    httpx
    -e packages/starlette-oasis

    pytest
    PyYAML
    pytest-asyncio

    coverage
commands = 
    coverage erase
    coverage run --append -m pytest
    coverage run --append -m sphinx -E -a docs docs/_build
    coverage html